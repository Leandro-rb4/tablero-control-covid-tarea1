---
title: "COVID-19 en Costa Rica"
output: 
  flexdashboard::flex_dashboard:
    orientation: rows
    vertical_layout: fill
    
---

```{r setup, include=FALSE}
library(flexdashboard)

library(sf)

library(leaflet)

library(knitr)

library(kableExtra)

library(dplyr)

library(spData)

library(ggplot2)

#Covid-19 en Costa Rica
covid19_cr = (st_read("https://raw.githubusercontent.com/geoprocesamiento-2020i/datos/master/covid19/casos/cr/cr-covid19-cantones.geojson"))

```


País y Provincias {data-width=500}
=======================================================================


Column {data-width=300}
-----------------------------------------------------------------------

### Casos confirmados de COVID-19 en Costa Rica

```{r}
confirmados_total = sum(as.numeric(covid19_cr$confirmados), na.rm = TRUE)

valueBox(confirmados_total, icon = "fa-pencil", color = "purple")
```

### Casos recuperados de COVID-19 en Costa Rica

```{r}
recuperados_total = sum(as.numeric(covid19_cr$recuperados), na.rm = TRUE)

valueBox(recuperados_total, icon = "fa-pencil", color = "purple")
```


### Casos activos de COVID-19 en Costa Rica

```{r}
activos_total = sum(as.numeric(covid19_cr$activos), na.rm = TRUE)

valueBox(activos_total, icon = "fa-pencil", color = "purple")
```

### Casos de fallecidos por COVID-19 en Costa Rica

```{r}
muertes_total = sum(as.numeric(covid19_cr$muertes), na.rm = TRUE)

valueBox(muertes_total, icon = "fa-pencil", color = "purple")
```

Column {data-width=700}
-----------------------------------------------------------------------

### Chart Bb

```{r}
```


### Casos confirmados de COVID-19 por provincia en Costa Rica

```{r}

confirmados_cr = aggregate(
  data = covid19_cr, 
  confirmados ~ provincia, 
  FUN = sum, 
  na.rm = TRUE
)

ggplot(confirmados_cr, aes(x=reorder(provincia,-confirmados), y=confirmados)) +
   xlab("Provincia") + 
   ylab("Casos de COVID-19 ") +  
   geom_col() +
   geom_text(aes(label= confirmados), vjust=-0.3, size=3.5)

```



Cantones {data-width=500}
=======================================================================

Column {data-width=500}
-----------------------------------------------------------------------
### Chart C

```{r}
```


### Casos confirmados, recuperados, fallecidos y activos de COVID-19 por cantón en Costa Rica

```{r}
covid19_cr %>%
  select(Cantón = canton, Confirmados = confirmados, Recuperados =recuperados, Fallecidos = muertes, Activos = activos)%>%
  arrange(Cantón) %>%
  st_drop_geometry() %>%
  kable()%>%
  kable_styling() %>%
  scroll_box(
    width = "630px", 
    height = "540px", 
    fixed_thead = TRUE
  )
```

